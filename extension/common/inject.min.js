(function(){var r,n,t,i=function(n){typeof n=="string"?console.log("PBULLY: "+n):console.log(n)};n={list:[],checkedList:[],checkmark:chrome.runtime.getURL("common/images/checkmark.png"),checkThis:function(t){console.log(t);n.check(this)},clickPush:function(t){console.log(t);n.highlight(this)},initialize:function(t){t.classList.contains("pushbully")||(t.classList.add("pushbully"),t.onclick=n.clickPush)},refresh:function(i,r){if(n.list=document.getElementsByClassName("push"),!r){n.checkedList=document.getElementsByClassName("pushbully checked");for(var u=n.list.length-1;u>=0;--u)n.initialize(n.list[u],u)}i&&n.deselectAll();t.update()},scrollIntoView:function(n){var u=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,f=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,i=0,r=0,t;if(document.layers)i=n.y,r=n.height;else{for(t=n;t&&t.tagName!=="BODY";t=t.offsetParent)i+=t.offsetTop;r=n.offsetHeight}u+f<i+r?n.scrollIntoView(!1):i<u&&n.scrollIntoView(!0)},highlight:function(t){for(var r=t.classList.contains("highlit"),u=document.getElementsByClassName("highlit"),i=0,f=u.length;i<f;i++)u[i].classList.remove("highlit");return r||(t.classList.add("highlit"),n.scrollIntoView(t)),r},check:function(t,r,u){var s,f,o,e;return t.classList.contains("pushbully")?s=t.classList.contains("checked"):n.initialize(t),f=t.getElementsByClassName("profile-pic")[0],r=t.classList.toggle("checked",r===undefined?!s:r),r?(o="Click to save this push from certain doom.",e=f.getAttribute("src"),f.setAttribute("data-prevsrc",e),f.setAttribute("src",n.checkmark)):(o="Click to mark this push for destruction.",e=f.getAttribute("data-prevsrc"),e&&(f.setAttribute("src",e),f.removeAttribute("data-prevsrc"))),f.setAttribute("title",o),u||(n.refresh(),i(t)),r},doSelect:function(t){for(var i=n.list.length-1;i>=0;i--)n.check(n.list[i],t,!0);n.refresh()},selectAll:function(){n.doSelect(!0)},deselectAll:function(){n.doSelect(!1)},pDelete:function(t){var u,r,s,f,e,o;(n.refresh(),u=t?n.list:n.checkedList,r=u.length,r>5&&(s=!confirm("Are you sure you would like to delete "+(t?"all %+":"these %").replace("%",r)+" pushes?\n\nThis cannot be canceled nor undone."),s))||(e=0,o=function(){if(n.refresh(),u=t?n.list:n.checkedList,r=u.length,r>0){for(f=r-1;f>=0;f--)u[f].getElementsByClassName("push-close")[0].click(),e++;if(t){window.setTimeout(o,500);return}}i("Deletion complete. Deleted "+e+" pushes.");window.setTimeout(function(){n.refresh(!1,!0)},500)},o())},deleteAll:function(){n.pDelete(!0)},deleteSelected:function(){n.pDelete(!1)}};t={selectAll:null,deleteSelected:null,deleteAll:null,inject:function(){var o,u,e,f;return(i("Injecting buttons..."),!r.pushListDiv)?(i("buttons.inject: main.pushListDiv not found. Stopping inject..."),!1):(o=document.getElementsByClassName("pushframe")[0],u=document.getElementById("pushbully-button-box"),!o)?(i("buttons.inject: pushFrame not found. Stopping inject..."),!1):(u?(u.parentElement.removeChild(u),i("buttons.inject: Buttons div deleted.")):i("buttons.inject: Buttons div doesn't exist."),i("buttons.inject: Injecting buttons..."),u=document.createElement("div"),u.id="pushbully-button-box",o.insertAdjacentElement("afterEnd",u),i("buttonsDiv:"),i(u),e="btn pushbully-button",f=document.createElement("button"),f.innerText="Refresh Boxes",f.className=e,f.id="refresh-boxes-button",f.title="Sometimes pushes won't have checkboxes on them. Click this to fix that.",f.onclick=function(){n.refresh(!0)},t.deleteAll=document.createElement("button"),t.deleteAll.innerText="Delete All",t.deleteAll.className=e,t.deleteAll.id="delete-all-button",t.deleteAll.title="Click to delete all of your pushes.",t.deleteAll.onclick=n.deleteAll,t.selectAll=document.createElement("button"),t.selectAll.innerText="Select All",t.selectAll.className=e,t.selectAll.id="select-all-button",t.deleteSelected=document.createElement("button"),t.deleteSelected.innerText="Delete Selected",t.deleteSelected.className=e,t.deleteSelected.id="delete-selected-button",t.deleteSelected.title="Click to delete all selected pushes.",t.deleteSelected.onclick=n.deleteSelected,u.appendChild(t.selectAll),u.appendChild(t.deleteSelected),u.appendChild(f),u.appendChild(t.deleteAll),i("Button box and buttons injected."),!0)},update:function(){n.list.length&&n.checkedList.length?(t.deleteSelected.innerText="Delete Selected ("+n.checkedList.length+")",t.selectAll.onclick=n.deselectAll,t.selectAll.innerText="Deselect All",t.selectAll.title="Click to deselect all selected pushes."):(t.deleteSelected.innerText="Delete Selected",t.selectAll.onclick=n.selectAll,t.selectAll.innerText="Select All"+(n.list.length?" ("+n.list.length+")":""),t.selectAll.title="Click to select all pushes on the first page.");t.selectAll.disabled=t.deleteAll.disabled=!n.list.length;t.deleteSelected.disabled=!n.checkedList.length}};r={doReset:function(){r.pushListDiv=document.getElementsByClassName("physics")[0];t.inject()&&n.refresh()},reset:function(n){n?window.setTimeout(r.doReset,n):r.doReset()},initialize:function(){var t,u,n,f;r.reset();try{t=window.MutationObserver||window.WebKitMutationObserver||new MutationObserver;u=new t(function(n){n.forEach(function(n){var r,u,t,f;if(n.addedNodes)for(r=0,t=0,f=n.addedNodes.length;t<f;t++)u=n.addedNodes[t],u.className==="push"&&i("Mutation: New push found (count = "+r+++"). Propogating...")})});u.observe(r.pushListDiv,{childList:!0,subtree:!0});i("Initialize: Attached mutation observer to listen for new pushes.")}catch(e){i(e);i("Initialize: Could not attach mutation observer due to error:")}n=window.history;f=n.pushState;n.pushState=function(t){if(i("PushState: wHist.pushState state changed. Resetting..."),n.onpushstate)n.onpushstate({state:t});return r.reset(500),f.apply(n,arguments)};window.onhashchange=window.onpopstate=window.onpushstate=function(){r.reset(500)};i("Initialize: Attached pop state listener to listen for page change.")}};r.initialize()})();
/*
//# sourceMappingURL=inject.min.js.map
*/